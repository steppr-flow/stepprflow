import{u as $,k as x,l as g,o as R,b as i,c as l,d as t,m as _,v as b,F as v,r as C,f as r,g as m,t as c,e as E,n as L,p as F,q as T,s as M}from"./index-joplyjTx.js";import{_ as G}from"./StatusBadge-Cuy5KiUG.js";import{_ as A,f as V}from"./ConfirmModal-BvCGghS8.js";const O={class:"space-y-6"},B={class:"card-compact flex flex-wrap items-center gap-3"},z={class:"flex flex-wrap gap-1.5"},H=["onClick"],U={class:"card overflow-hidden !p-0"},Y={key:0,class:"p-8 text-center text-sm text-gray-400"},j={key:1,class:"w-full text-sm"},q={class:"divide-y divide-gray-50"},Q={key:0},W=["onClick"],J={class:"px-4 py-3 font-mono text-xs text-gray-600 max-w-[200px] truncate"},K={class:"px-4 py-3 font-medium text-gray-900"},X={class:"px-4 py-3"},Z={class:"px-4 py-3 text-gray-500"},tt={class:"flex items-center gap-2"},et={class:"h-1.5 w-16 rounded-full bg-gray-100 overflow-hidden"},st={class:"text-xs"},ot={class:"px-4 py-3 text-xs text-gray-500"},nt=["onClick"],at=["onClick"],it={key:0,class:"flex items-center justify-between"},lt={class:"text-sm text-gray-500"},rt={class:"flex gap-2"},ct=["disabled"],ut=["disabled"],xt={__name:"Executions",setup(dt){const s=$(),w=["PENDING","IN_PROGRESS","COMPLETED","FAILED","RETRY_PENDING","CANCELLED"],d=x(s.filters.search),p=x(s.filters.topic),u=x([...s.filters.status]),n=L({show:!1,title:"",message:"",type:"warning",confirmLabel:"Confirm",onConfirm:()=>{}});let y;g(d,o=>{clearTimeout(y),y=setTimeout(()=>{s.setFilters({search:o}),s.fetchExecutions()},300)}),g(p,o=>{s.setFilters({topic:o}),s.fetchExecutions()}),g(u,o=>{s.setFilters({status:[...o]}),s.fetchExecutions()},{deep:!0});function k(o){const a=u.value.indexOf(o);a>=0?u.value.splice(a,1):u.value.push(o)}function I(){d.value="",p.value="",u.value=[]}function N(o){return o.totalSteps?Math.round(o.currentStep/o.totalSteps*100):0}function P(o){return o?V(new Date(o),"MMM d, HH:mm:ss"):"-"}function h(o){s.setPage(s.pagination.page+o),s.fetchExecutions()}function S(o){n.title="Resume Execution",n.message=`Resume execution ${o.executionId} for topic "${o.topic}"?`,n.type="info",n.confirmLabel="Resume",n.onConfirm=async()=>{n.show=!1,await s.resumeExecution(o.executionId),s.fetchExecutions()},n.show=!0}function D(o){n.title="Cancel Execution",n.message=`Cancel execution ${o.executionId}? This cannot be undone.`,n.type="danger",n.confirmLabel="Cancel Execution",n.onConfirm=async()=>{n.show=!1,await s.cancelExecution(o.executionId),s.fetchExecutions()},n.show=!0}return R(()=>{s.fetchExecutions()}),(o,a)=>(i(),l("div",O,[a[8]||(a[8]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Executions",-1)),t("div",B,[_(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>d.value=e),class:"input max-w-xs",placeholder:"Search by ID or topic..."},null,512),[[b,d.value]]),_(t("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>p.value=e),class:"input max-w-[180px]",placeholder:"Filter by topic..."},null,512),[[b,p.value]]),t("div",z,[(i(),l(v,null,C(w,e=>t("button",{key:e,class:F(["rounded-full border px-2.5 py-1 text-xs font-medium transition-colors",u.value.includes(e)?"border-primary-300 bg-primary-50 text-primary-700":"border-gray-200 bg-white text-gray-500 hover:border-gray-300"]),onClick:f=>k(e)},c(e),11,H)),64))]),t("button",{class:"btn-secondary btn-sm ml-auto",onClick:I},"Clear")]),t("div",U,[r(s).loading?(i(),l("div",Y,"Loading...")):(i(),l("table",j,[a[7]||(a[7]=t("thead",null,[t("tr",{class:"border-b border-gray-100 bg-gray-50 text-left text-xs font-medium uppercase tracking-wide text-gray-500"},[t("th",{class:"px-4 py-3"},"Execution ID"),t("th",{class:"px-4 py-3"},"Topic"),t("th",{class:"px-4 py-3"},"Status"),t("th",{class:"px-4 py-3"},"Progress"),t("th",{class:"px-4 py-3"},"Created"),t("th",{class:"px-4 py-3 text-right"},"Actions")])],-1)),t("tbody",q,[r(s).executions.length===0?(i(),l("tr",Q,[...a[6]||(a[6]=[t("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-400"},"No executions found",-1)])])):m("",!0),(i(!0),l(v,null,C(r(s).executions,e=>(i(),l("tr",{key:e.executionId,class:"hover:bg-gray-50 transition-colors cursor-pointer",onClick:f=>o.$router.push(`/executions/${e.executionId}`)},[t("td",J,c(e.executionId),1),t("td",K,c(e.topic),1),t("td",X,[E(G,{status:e.status},null,8,["status"])]),t("td",Z,[t("div",tt,[t("div",et,[t("div",{class:"h-full rounded-full bg-primary-500 transition-all",style:T({width:N(e)+"%"})},null,4)]),t("span",st,c(e.currentStep??0)+"/"+c(e.totalSteps??0),1)])]),t("td",ot,c(P(e.createdAt)),1),t("td",{class:"px-4 py-3 text-right",onClick:a[2]||(a[2]=M(()=>{},["stop"]))},[e.status==="FAILED"||e.status==="RETRY_PENDING"?(i(),l("button",{key:0,class:"btn-success btn-sm mr-1",onClick:f=>S(e)}," Resume ",8,nt)):m("",!0),e.status==="IN_PROGRESS"||e.status==="PENDING"?(i(),l("button",{key:1,class:"btn-danger btn-sm",onClick:f=>D(e)}," Cancel ",8,at)):m("",!0)])],8,W))),128))])]))]),r(s).pagination.totalPages>1?(i(),l("div",it,[t("span",lt,c(r(s).pagination.totalElements)+" results â€” page "+c(r(s).pagination.page+1)+" of "+c(r(s).pagination.totalPages),1),t("div",rt,[t("button",{class:"btn-secondary btn-sm",disabled:!r(s).hasPrevPage,onClick:a[3]||(a[3]=e=>h(-1))},"Previous",8,ct),t("button",{class:"btn-secondary btn-sm",disabled:!r(s).hasNextPage,onClick:a[4]||(a[4]=e=>h(1))},"Next",8,ut)])])):m("",!0),E(A,{show:n.show,title:n.title,message:n.message,type:n.type,"confirm-label":n.confirmLabel,onConfirm:n.onConfirm,onCancel:a[5]||(a[5]=e=>n.show=!1)},null,8,["show","title","message","type","confirm-label","onConfirm"])]))}};export{xt as default};
